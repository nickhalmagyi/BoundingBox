(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     44995,       1325]
NotebookOptionsPosition[     41623,       1209]
NotebookOutlinePosition[     42146,       1227]
CellTagsIndexPosition[     42103,       1224]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Haversine Definitions", "Section",
 CellChangeTimes->{{3.7659435551927357`*^9, 3.7659435641557827`*^9}, {
   3.7660005624905357`*^9, 3.766000576613583*^9}, 3.766000650698851*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"$Assumptions", " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"\[Lambda]1", ",", "\[Lambda]2"}], "}"}], ">", 
    RowBox[{"-", "\[Pi]"}]}], " ", "&&", " ", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"\[Lambda]1", ",", "\[Lambda]2"}], "}"}], " ", "<", " ", 
    "\[Pi]"}], " ", "&&", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"\[CurlyPhi]1", ",", " ", "\[CurlyPhi]2"}], "}"}], ">", 
    RowBox[{
     RowBox[{"-", "\[Pi]"}], "/", "2"}]}], " ", "&&", " ", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"\[CurlyPhi]1", ",", " ", "\[CurlyPhi]2"}], "}"}], "<", 
    RowBox[{"\[Pi]", "/", "2"}]}], " ", "&&", " ", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "\[Lambda]1", ",", " ", "\[Lambda]2", ",", " ", "\[CurlyPhi]1", ",", " ",
       "\[CurlyPhi]2", ",", " ", "dd", ",", " ", "DD"}], "}"}], "\[Element]", 
    "Reals"}], " ", "&&", " ", 
   RowBox[{"dd", "<", "DD"}]}]}]], "Input",
 CellChangeTimes->{{3.765962047679665*^9, 3.765962125456521*^9}, {
  3.765962211159028*^9, 3.765962236909329*^9}, {3.7659622932878447`*^9, 
  3.765962296346027*^9}, {3.7660130253347883`*^9, 3.766013069876562*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"\[Lambda]1", ",", "\[Lambda]2"}], "}"}], ">", 
   RowBox[{"-", "\[Pi]"}]}], "&&", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"\[Lambda]1", ",", "\[Lambda]2"}], "}"}], "<", "\[Pi]"}], "&&", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"\[CurlyPhi]1", ",", "\[CurlyPhi]2"}], "}"}], ">", 
   RowBox[{"-", 
    FractionBox["\[Pi]", "2"]}]}], "&&", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"\[CurlyPhi]1", ",", "\[CurlyPhi]2"}], "}"}], "<", 
   FractionBox["\[Pi]", "2"]}], "&&", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
    "\[Lambda]1", "|", "\[Lambda]2", "|", "\[CurlyPhi]1", "|", "\[CurlyPhi]2",
      "|", "dd", "|", "DD"}], ")"}], "\[Element]", "Reals"}], "&&", 
  RowBox[{"dd", "<", "DD"}]}]], "Output",
 CellChangeTimes->{
  3.765962091726688*^9, 3.7659621258884287`*^9, {3.765962228948703*^9, 
   3.76596223728677*^9}, 3.765962296706661*^9, 3.766013070378643*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"Hav", "[", 
   RowBox[{
   "dd_", ",", " ", "DD_", ",", " ", "\[Lambda]1", ",", " ", "\[Lambda]2", 
    ",", " ", "\[CurlyPhi]1", ",", " ", "\[CurlyPhi]2"}], "]"}], ":=", " ", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"Cos", "[", 
       FractionBox["dd", "DD"], "]"}]}], "+", 
     RowBox[{
      RowBox[{"Cos", "[", 
       RowBox[{"\[Lambda]1", "-", "\[Lambda]2"}], "]"}], " ", 
      RowBox[{"Cos", "[", "\[CurlyPhi]1", "]"}], " ", 
      RowBox[{"Cos", "[", "\[CurlyPhi]2", "]"}]}], "+", 
     RowBox[{
      RowBox[{"Sin", "[", "\[CurlyPhi]1", "]"}], " ", 
      RowBox[{"Sin", "[", "\[CurlyPhi]2", "]"}]}]}], ")"}], "//", 
   "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.765945493436419*^9, 3.765945502888649*^9}, {
   3.765946304962973*^9, 3.765946310248354*^9}, {3.765946348952724*^9, 
   3.765946412703187*^9}, {3.76594657639063*^9, 3.765946580355348*^9}, {
   3.765955201511222*^9, 3.765955205686018*^9}, {3.765955402639439*^9, 
   3.765955404356702*^9}, {3.7659572735723953`*^9, 3.7659572774369383`*^9}, {
   3.765957379867508*^9, 3.765957392394767*^9}, {3.766000614358799*^9, 
   3.766000615211401*^9}, 3.766090060729002*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Solving for the maximum longitude", "Section",
 CellChangeTimes->{{3.76600062679006*^9, 3.766000645942988*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[Lambda]2Sol", " ", "=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"Solve", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Hav", "[", 
         RowBox[{
         "dd", ",", " ", "DD", ",", " ", "\[Lambda]1", ",", " ", "\[Lambda]2",
           ",", " ", "\[CurlyPhi]1", ",", " ", "\[CurlyPhi]2"}], "]"}], 
        "\[Equal]", "0"}], ",", " ", "\[Lambda]2"}], "]"}], "/.", 
     RowBox[{
      RowBox[{"C", "[", "1", "]"}], "\[Rule]", "0"}]}], "//", "Simplify"}], 
   ")"}]}]], "Input",
 CellChangeTimes->{{3.76594646533745*^9, 3.765946533408518*^9}, {
   3.765946595495944*^9, 3.765946603911448*^9}, {3.765948870563097*^9, 
   3.765948872230735*^9}, {3.7659545144308157`*^9, 3.765954541734256*^9}, {
   3.7659549707377777`*^9, 3.765954995608263*^9}, {3.765955048617283*^9, 
   3.765955094622607*^9}, 3.765959907260232*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"\[Lambda]2", "\[Rule]", 
     RowBox[{"\[Lambda]1", "-", 
      RowBox[{"ArcCos", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Cos", "[", 
          FractionBox["dd", "DD"], "]"}], " ", 
         RowBox[{"Sec", "[", "\[CurlyPhi]1", "]"}], " ", 
         RowBox[{"Sec", "[", "\[CurlyPhi]2", "]"}]}], "-", 
        RowBox[{
         RowBox[{"Tan", "[", "\[CurlyPhi]1", "]"}], " ", 
         RowBox[{"Tan", "[", "\[CurlyPhi]2", "]"}]}]}], "]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Lambda]2", "\[Rule]", 
     RowBox[{"\[Lambda]1", "+", 
      RowBox[{"ArcCos", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Cos", "[", 
          FractionBox["dd", "DD"], "]"}], " ", 
         RowBox[{"Sec", "[", "\[CurlyPhi]1", "]"}], " ", 
         RowBox[{"Sec", "[", "\[CurlyPhi]2", "]"}]}], "-", 
        RowBox[{
         RowBox[{"Tan", "[", "\[CurlyPhi]1", "]"}], " ", 
         RowBox[{"Tan", "[", "\[CurlyPhi]2", "]"}]}]}], "]"}]}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.7659464782097483`*^9, 3.765946503813567*^9}, 
   3.7659465339194813`*^9, {3.76594659246004*^9, 3.765946604255529*^9}, 
   3.765948872779007*^9, {3.765954515656308*^9, 3.765954542246669*^9}, {
   3.765954989032092*^9, 3.76595499606182*^9}, {3.7659550563405037`*^9, 
   3.765955094991997*^9}, 3.765955211112108*^9, 3.7659573259651737`*^9, {
   3.765957395499405*^9, 3.765957399688796*^9}, 3.765959853001933*^9, 
   3.765959908236474*^9, 3.7659622424268513`*^9, 3.7659623000696573`*^9, {
   3.766000679281901*^9, 3.76600069377169*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"\[CurlyPhi]2maxsol", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"Solve", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"\[Lambda]2", "/.", "\[Lambda]2Sol"}], ")"}], "//", 
            "Simplify"}], ",", "\[CurlyPhi]2"}], "]"}], "\[Equal]", "0"}], "//",
         "Simplify"}], ",", "\[CurlyPhi]2"}], "]"}], "[", 
     RowBox[{"[", "2", "]"}], "]"}], "//", "Simplify"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.765946538600618*^9, 3.765946560228533*^9}, {
   3.765948107080097*^9, 3.7659482528254213`*^9}, {3.765957434714176*^9, 
   3.76595743500765*^9}, {3.765959838183022*^9, 3.765959838544244*^9}, 
   3.7660006680065947`*^9, {3.7660007231354103`*^9, 3.766000723663475*^9}}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Solve", "::", "ifun"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Inverse functions are being used by \
\[NoBreak]\\!\\(Solve\\)\[NoBreak], so some solutions may not be found; use \
Reduce for complete solution information. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/Solve/ifun\\\", ButtonNote -> \
\\\"Solve::ifun\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{
  3.765948126546977*^9, {3.765948168048316*^9, 3.765948253497561*^9}, {
   3.765957419694025*^9, 3.765957435737679*^9}, {3.7659598390824957`*^9, 
   3.765959855487833*^9}, 3.765962247166959*^9, 3.765962303876626*^9, 
   3.766000668580777*^9, {3.7660006989197683`*^9, 3.7660007246821737`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[Lambda]2maxSol", " ", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"\[Lambda]2Sol", "/.", "\[CurlyPhi]2maxsol"}], "/.", " ", 
    RowBox[{
     SqrtBox[
      RowBox[{
       SuperscriptBox[
        RowBox[{"Sec", "[", 
         FractionBox["dd", "DD"], "]"}], "2"], " ", 
       SuperscriptBox[
        RowBox[{"Sin", "[", "\[CurlyPhi]1", "]"}], "2"]}]], "\[Rule]", " ", 
     RowBox[{
      RowBox[{"Sec", "[", 
       FractionBox["dd", "DD"], "]"}], " ", 
      RowBox[{"Sin", "[", "\[CurlyPhi]1", "]"}]}]}]}], "//", 
   "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.765951937803636*^9, 3.7659519856866293`*^9}, {
   3.765957688115676*^9, 3.765957717162108*^9}, {3.765957896207657*^9, 
   3.765957915372485*^9}, 3.765962269347293*^9, 3.766000665158976*^9, 
   3.766000727608945*^9, 3.7660009516616983`*^9, {3.76601312030256*^9, 
   3.766013128037197*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"\[Lambda]2", "\[Rule]", 
     RowBox[{"\[Lambda]1", "-", 
      RowBox[{"ArcCos", "[", 
       RowBox[{
        FractionBox["1", 
         RowBox[{
          RowBox[{"Cos", "[", 
           FractionBox[
            RowBox[{"2", " ", "dd"}], "DD"], "]"}], "+", 
          RowBox[{"Cos", "[", 
           RowBox[{"2", " ", "\[CurlyPhi]1"}], "]"}]}]], 
        RowBox[{"2", " ", 
         SuperscriptBox[
          RowBox[{"Cos", "[", 
           FractionBox["dd", "DD"], "]"}], "2"], " ", 
         RowBox[{"Sec", "[", "\[CurlyPhi]1", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Cos", "[", 
            FractionBox["dd", "DD"], "]"}], "-", 
           RowBox[{
            RowBox[{"Abs", "[", 
             RowBox[{"Sec", "[", 
              FractionBox["dd", "DD"], "]"}], "]"}], " ", 
            RowBox[{"Abs", "[", 
             RowBox[{"Sin", "[", "\[CurlyPhi]1", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", "\[CurlyPhi]1", "]"}]}]}], ")"}], " ", 
         SqrtBox[
          RowBox[{"1", "-", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"Sec", "[", 
              FractionBox["dd", "DD"], "]"}], "2"], " ", 
            SuperscriptBox[
             RowBox[{"Sin", "[", "\[CurlyPhi]1", "]"}], "2"]}]}]]}]}], 
       "]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Lambda]2", "\[Rule]", 
     RowBox[{"\[Lambda]1", "+", 
      RowBox[{"ArcCos", "[", 
       RowBox[{
        FractionBox["1", 
         RowBox[{
          RowBox[{"Cos", "[", 
           FractionBox[
            RowBox[{"2", " ", "dd"}], "DD"], "]"}], "+", 
          RowBox[{"Cos", "[", 
           RowBox[{"2", " ", "\[CurlyPhi]1"}], "]"}]}]], 
        RowBox[{"2", " ", 
         SuperscriptBox[
          RowBox[{"Cos", "[", 
           FractionBox["dd", "DD"], "]"}], "2"], " ", 
         RowBox[{"Sec", "[", "\[CurlyPhi]1", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Cos", "[", 
            FractionBox["dd", "DD"], "]"}], "-", 
           RowBox[{
            RowBox[{"Abs", "[", 
             RowBox[{"Sec", "[", 
              FractionBox["dd", "DD"], "]"}], "]"}], " ", 
            RowBox[{"Abs", "[", 
             RowBox[{"Sin", "[", "\[CurlyPhi]1", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", "\[CurlyPhi]1", "]"}]}]}], ")"}], " ", 
         SqrtBox[
          RowBox[{"1", "-", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"Sec", "[", 
              FractionBox["dd", "DD"], "]"}], "2"], " ", 
            SuperscriptBox[
             RowBox[{"Sin", "[", "\[CurlyPhi]1", "]"}], "2"]}]}]]}]}], 
       "]"}]}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.766000727935265*^9, 3.7660009521623077`*^9, 
  3.766013129142754*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"latlonmaxReps", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[CurlyPhi]2maxsol", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"\[Lambda]2maxSol", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[CurlyPhi]2maxsol", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"\[Lambda]2maxSol", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "1"}], "]"}], "]"}]}], "}"}]}], "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.766000958881583*^9, 3.766000987903533*^9}, {
  3.766001227422193*^9, 3.766001257243696*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"1", "-", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"Sec", "[", 
      FractionBox["dd", "DD"], "]"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"Sin", "[", "\[CurlyPhi]1", "]"}], "2"]}]}], "/.", 
  RowBox[{"{", " ", 
   RowBox[{
    RowBox[{"\[CurlyPhi]1", "\[Rule]", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"\[Pi]", "/", "2"}], "-", "0.1"}], ")"}]}], ",", " ", 
    RowBox[{"DD", "\[Rule]", " ", "6371"}], ",", " ", 
    RowBox[{"dd", "\[Rule]", "1000"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.7660132545039873`*^9, 3.766013294042576*^9}}],

Cell[BoxData[
 RowBox[{"-", "0.014830850143032315`"}]], "Output",
 CellChangeTimes->{{3.7660132671485357`*^9, 3.766013294511538*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["NDSolve for max longitude", "Section",
 CellChangeTimes->{{3.766014369703082*^9, 3.7660143754177923`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Eqs", " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"0", "==", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"Sin", "[", "\[CurlyPhi]1", "]"}], 
           RowBox[{"-", "1"}]], 
          RowBox[{"(", " ", 
           RowBox[{
            RowBox[{"Hav", "[", 
             RowBox[{
             "dd", ",", " ", "DD", ",", " ", "\[Lambda]1", ",", " ", 
              "\[Lambda]2", ",", " ", "\[CurlyPhi]1", ",", " ", 
              "\[CurlyPhi]2"}], "]"}], "/.", " ", 
            RowBox[{"\[Lambda]2", "\[Rule]", 
             RowBox[{"\[Lambda]2", "[", "\[CurlyPhi]2", "]"}]}]}], ")"}]}]}], 
        "//", "Simplify"}], ",", 
       RowBox[{"0", "\[Equal]", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"Sin", "[", "\[CurlyPhi]1", "]"}], 
          RowBox[{"-", "1"}]], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Hav", "[", 
               RowBox[{
               "dd", ",", " ", "DD", ",", " ", "\[Lambda]1", ",", " ", 
                "\[Lambda]2", ",", " ", "\[CurlyPhi]1", ",", " ", 
                "\[CurlyPhi]2"}], "]"}], "/.", " ", 
              RowBox[{"\[Lambda]2", "\[Rule]", 
               RowBox[{"\[Lambda]2", "[", "\[CurlyPhi]2", "]"}]}]}], ",", 
             "\[CurlyPhi]2"}], "]"}], "/.", 
           RowBox[{
            RowBox[{
             SuperscriptBox["\[Lambda]2", "\[Prime]",
              MultilineFunction->None], "[", "\[CurlyPhi]2", "]"}], "\[Rule]",
             "0"}]}], ")"}]}]}]}], " ", "}"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"Cos", "[", 
         RowBox[{"\[Lambda]1", "-", 
          RowBox[{"\[Lambda]2", "[", "\[CurlyPhi]2", "]"}]}], "]"}], 
        "\[Rule]", " ", "\[CapitalLambda]"}], ",", " ", 
       RowBox[{
        RowBox[{"Cos", "[", "\[CurlyPhi]2", "]"}], "\[Rule]", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "-", 
           SuperscriptBox["\[CapitalPsi]", "2"]}], ")"}], 
         RowBox[{"1", "/", "2"}]]}], " ", ",", 
       RowBox[{
        RowBox[{"Sin", "[", "\[CurlyPhi]2", "]"}], "\[Rule]", " ", 
        "\[CapitalPsi]"}]}], "}"}]}], "/.", 
    RowBox[{"DD", "\[Rule]", "1"}]}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Solve", "[", 
   RowBox[{"Eqs", ",", " ", 
    RowBox[{"{", 
     RowBox[{"\[CapitalLambda]", ",", "\[CapitalPsi]"}], "}"}]}], "]"}], "//",
   "Simplify"}]}], "Input",
 CellChangeTimes->{{3.7660143774177856`*^9, 3.766014399230193*^9}, {
   3.766014534814019*^9, 3.766014571424572*^9}, {3.766014606847536*^9, 
   3.766014726404204*^9}, {3.7660312091071997`*^9, 3.766031211102153*^9}, {
   3.7660313406697397`*^9, 3.7660313483931007`*^9}, {3.766031403139329*^9, 
   3.766031446609823*^9}, {3.76603193069077*^9, 3.766031943398589*^9}, 
   3.766043099686137*^9, {3.766044349555265*^9, 3.766044351324431*^9}, {
   3.766090069618763*^9, 3.76609007347237*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"\[CapitalPsi]", "+", 
     RowBox[{"\[CapitalLambda]", " ", 
      SqrtBox[
       RowBox[{"1", "-", 
        SuperscriptBox["\[CapitalPsi]", "2"]}]], " ", 
      RowBox[{"Cot", "[", "\[CurlyPhi]1", "]"}]}]}], "\[Equal]", 
    RowBox[{
     RowBox[{"Cos", "[", "dd", "]"}], " ", 
     RowBox[{"Csc", "[", "\[CurlyPhi]1", "]"}]}]}], ",", 
   RowBox[{
    SqrtBox[
     RowBox[{"1", "-", 
      SuperscriptBox["\[CapitalPsi]", "2"]}]], "\[Equal]", 
    RowBox[{"\[CapitalLambda]", " ", "\[CapitalPsi]", " ", 
     RowBox[{"Cot", "[", "\[CurlyPhi]1", "]"}]}]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.766014572037722*^9, 3.766014615109721*^9, {3.766014709251223*^9, 
   3.76601472688559*^9}, 3.7660312113121862`*^9, 3.76603134894488*^9, {
   3.766031405531801*^9, 3.7660314471492443`*^9}, 3.766031569048234*^9, {
   3.766031939159279*^9, 3.766031943706791*^9}, 3.766043100864216*^9, 
   3.7660443517845907`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"\[CapitalLambda]", "\[Rule]", 
     RowBox[{
      RowBox[{"Cos", "[", "dd", "]"}], " ", 
      RowBox[{"Sec", "[", "\[CurlyPhi]1", "]"}], " ", 
      SqrtBox[
       RowBox[{"1", "-", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"Sec", "[", "dd", "]"}], "2"], " ", 
         SuperscriptBox[
          RowBox[{"Sin", "[", "\[CurlyPhi]1", "]"}], "2"]}]}]]}]}], ",", 
    RowBox[{"\[CapitalPsi]", "\[Rule]", 
     RowBox[{
      RowBox[{"Sec", "[", "dd", "]"}], " ", 
      RowBox[{"Sin", "[", "\[CurlyPhi]1", "]"}]}]}]}], "}"}], "}"}]], "Output",\

 CellChangeTimes->{
  3.766014572037722*^9, 3.766014615109721*^9, {3.766014709251223*^9, 
   3.76601472688559*^9}, 3.7660312113121862`*^9, 3.76603134894488*^9, {
   3.766031405531801*^9, 3.7660314471492443`*^9}, 3.766031569048234*^9, {
   3.766031939159279*^9, 3.766031943706791*^9}, 3.766043100864216*^9, 
   3.766044351871961*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"0", "==", 
       RowBox[{"1", "-", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"Sec", "[", 
           FractionBox["dd", "DD"], "]"}], "2"], " ", 
         RowBox[{"Sin", "[", "\[CurlyPhi]1", "]"}]}]}]}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"dd", "\[Rule]", "5000"}], ",", 
        RowBox[{"DD", "\[Rule]", "6371"}]}], "}"}]}], ",", "\[CurlyPhi]1"}], 
    "]"}], "/.", 
   RowBox[{
    RowBox[{"C", "[", "1", "]"}], "\[Rule]", "0"}]}], "//", "N"}]], "Input",
 CellChangeTimes->{{3.7660144167484426`*^9, 3.7660144965004997`*^9}, {
  3.766044138653661*^9, 3.766044189848219*^9}, {3.766044241757769*^9, 
  3.766044246522376*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"\[CurlyPhi]1", "\[Rule]", "2.6173101482833268`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[CurlyPhi]1", "\[Rule]", "0.5242825053064663`"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.766014429546307*^9, 3.766014447677114*^9}, {
  3.766014491063085*^9, 3.766014496917802*^9}, {3.766044164297526*^9, 
  3.766044190332246*^9}, {3.7660442423024273`*^9, 3.7660442467067413`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"1", "-", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"Sec", "[", 
      FractionBox["dd", "DD"], "]"}], "2"], " ", 
    RowBox[{"Sin", "[", "\[CurlyPhi]1", "]"}]}]}], "/.", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"\[CurlyPhi]1", "\[Rule]", ".6"}], ",", 
    RowBox[{"dd", "\[Rule]", "5000"}], ",", 
    RowBox[{"DD", "\[Rule]", "6371"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.766044217743034*^9, 3.766044227966288*^9}, {
  3.766044270836873*^9, 3.766044284268614*^9}}],

Cell[BoxData[
 RowBox[{"-", "0.127949431249754`"}]], "Output",
 CellChangeTimes->{{3.7660442202772913`*^9, 3.766044228284511*^9}, 
   3.766044284577004*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eq1", " ", "=", " ", 
  RowBox[{
   RowBox[{"Hav", "[", 
    RowBox[{
    "dd", ",", " ", "DD", ",", " ", "\[Lambda]1", ",", " ", "\[Lambda]2", ",",
      " ", "\[CurlyPhi]1", ",", " ", "\[CurlyPhi]2"}], "]"}], "/.", " ", 
   RowBox[{"\[Lambda]2", "\[Rule]", 
    RowBox[{"\[Lambda]2", "[", "\[CurlyPhi]2", "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.7660145259812*^9, 3.766014526774199*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", 
     RowBox[{"Cos", "[", 
      FractionBox["dd", "DD"], "]"}]}], "+", 
    RowBox[{
     RowBox[{"Cos", "[", "\[CurlyPhi]1", "]"}], " ", 
     RowBox[{"Cos", "[", "\[CurlyPhi]2", "]"}], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"\[Lambda]1", "-", 
       RowBox[{"\[Lambda]2", "[", "\[CurlyPhi]2", "]"}]}], "]"}]}], "+", 
    RowBox[{
     RowBox[{"Sin", "[", "\[CurlyPhi]1", "]"}], " ", 
     RowBox[{"Sin", "[", "\[CurlyPhi]2", "]"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.766014522017579*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Examples", "Section",
 CellChangeTimes->{{3.7660007568738317`*^9, 3.76600075897586*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"latmin", " ", "=", " ", 
   RowBox[{
    RowBox[{"-", "\[Pi]"}], "/", "2"}]}], ";", " ", 
  RowBox[{"latmax", " ", "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"lonmin", " ", "=", " ", 
    RowBox[{"-", "\[Pi]"}]}], ";", " ", 
   RowBox[{"lonmax", " ", "=", "\[Pi]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ddReps", "[", "x_", "]"}], "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"DD", "\[Rule]", " ", "6371"}], ",", " ", 
     RowBox[{"dd", "\[Rule]", "x"}]}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7660007795036697`*^9, 3.766000811003446*^9}, {
  3.766001059866365*^9, 3.766001081254076*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"NumEx", " ", "=", " ", "1000"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RandLatLonReps", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[CurlyPhi]1", "\[Rule]", 
        RowBox[{"RandomReal", "[", 
         RowBox[{"{", 
          RowBox[{"latmin", ",", "latmax"}], "}"}], "]"}]}], ",", 
       RowBox[{"\[Lambda]1", "\[Rule]", "  ", 
        RowBox[{"RandomReal", "[", 
         RowBox[{"{", 
          RowBox[{"lonmin", ",", "lonmax"}], "}"}], "]"}]}]}], "}"}], ",", 
     " ", 
     RowBox[{"{", 
      RowBox[{"i", ",", "NumEx"}], "}"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.766000773947365*^9, 3.766000773951219*^9}, {
  3.766000814267809*^9, 3.766000917542993*^9}, {3.7660010226474667`*^9, 
  3.76600104553211*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"RandLatLons", "[", 
  RowBox[{"[", "1", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.76600099907371*^9, 3.766001010188581*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"\[CurlyPhi]1", "\[Rule]", "1.013081505475741`"}], ",", 
   RowBox[{"\[Lambda]1", "\[Rule]", "2.4007254764238013`"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.766000999973818*^9, 3.766001010383773*^9}, 
   3.766001041633081*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"latlonmaxReps", "/.", 
   RowBox[{"RandLatLons", "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], "/.", 
  RowBox[{"ddReps", "[", "10", "]"}]}]], "Input",
 CellChangeTimes->{{3.766001051723394*^9, 3.76600105197033*^9}, {
  3.766001085066086*^9, 3.766001086256455*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[CurlyPhi]2", "\[Rule]", "1.0130834803114455`"}], "}"}], ",", 
     
     RowBox[{"{", 
      RowBox[{"\[Lambda]2", "\[Rule]", "2.397759736476769`"}], "}"}]}], "}"}],
    ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[CurlyPhi]2", "\[Rule]", "1.0130834803114455`"}], "}"}], ",", 
     
     RowBox[{"{", 
      RowBox[{"\[Lambda]2", "\[Rule]", "2.4036912163708335`"}], "}"}]}], 
    "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.76600105230188*^9, 3.766001086671483*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"z", " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Hav", "[", 
       RowBox[{
       "dd", ",", " ", "DD", ",", " ", "\[Lambda]1", ",", " ", "\[Lambda]2", 
        ",", " ", "\[CurlyPhi]1", ",", " ", "\[CurlyPhi]2"}], "]"}], "/.", 
      RowBox[{"latlonmaxReps", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], "/.", 
     RowBox[{"RandLatLons", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], "/.", 
    RowBox[{"ddReps", "[", "10", "]"}]}], "//", "N"}]}]], "Input",
 CellChangeTimes->{{3.7660011190926332`*^9, 3.7660011746502113`*^9}, 
   3.76600121047852*^9, {3.7660013250865793`*^9, 3.766001352046096*^9}, {
   3.7660014316481113`*^9, 3.766001432050264*^9}}],

Cell[BoxData["5.551115123125783`*^-17"], "Output",
 CellChangeTimes->{{3.7660011233918543`*^9, 3.766001174984788*^9}, 
   3.766001210834649*^9, 3.76600127482456*^9, {3.766001325594922*^9, 
   3.766001352548398*^9}, 3.766001432362582*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"z", "<", 
  SuperscriptBox["10", 
   RowBox[{"-", "8"}]]}]], "Input",
 CellChangeTimes->{{3.766001433633607*^9, 3.766001441498831*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.766001434596877*^9, 3.766001441881218*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"i", "=", "1"}], ",", " ", 
   RowBox[{"i", "<=", " ", 
    RowBox[{"Length", "[", "RandLatLons", "]"}]}], ",", " ", 
   RowBox[{"i", "++"}], ",", " ", 
   RowBox[{
    RowBox[{"z", " ", "=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Hav", "[", 
          RowBox[{
          "dd", ",", " ", "DD", ",", " ", "\[Lambda]1", ",", " ", 
           "\[Lambda]2", ",", " ", "\[CurlyPhi]1", ",", " ", "\[CurlyPhi]2"}],
           "]"}], "/.", 
         RowBox[{"latlonmaxReps", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "/.", 
        RowBox[{"RandLatLons", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], "/.", 
       RowBox[{"ddReps", "[", "10", "]"}]}], "//", "N"}]}], ";", " ", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"z", ">", 
       SuperscriptBox["10", 
        RowBox[{"-", "8"}]]}], ",", 
      RowBox[{"Print", "[", 
       RowBox[{"bad", " ", "precision"}], "]"}]}], "]"}]}]}], "]"}]], "Input",\

 CellChangeTimes->{{3.766001448900816*^9, 3.7660015414552517`*^9}, {
  3.766001689577914*^9, 3.766001809622538*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Length", "[", "RandLatLons", "]"}]], "Input",
 CellChangeTimes->{{3.7660014865575943`*^9, 3.7660014914002523`*^9}}],

Cell[BoxData["1000"], "Output",
 CellChangeTimes->{3.766001491819106*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Ex1", " ", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Lambda]1", "\[Rule]", "0"}], ",", " ", 
     RowBox[{"\[CurlyPhi]1", "\[Rule]", "0"}], ",", " ", 
     RowBox[{"DD", "\[Rule]", "6371"}], ",", " ", 
     RowBox[{"dd", "\[Rule]", "100"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Ex2", " ", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Lambda]1", "\[Rule]", "0"}], ",", " ", 
     RowBox[{"\[CurlyPhi]1", "\[Rule]", "0.01"}], ",", " ", 
     RowBox[{"DD", "\[Rule]", "6371"}], ",", " ", 
     RowBox[{"dd", "\[Rule]", "100"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Ex3", " ", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Lambda]1", "\[Rule]", "0"}], ",", " ", 
     RowBox[{"\[CurlyPhi]1", "\[Rule]", 
      RowBox[{
       RowBox[{"\[Pi]", "/", "2"}], "-", "0.1"}]}], ",", " ", 
     RowBox[{"DD", "\[Rule]", "6371"}], ",", " ", 
     RowBox[{"dd", "\[Rule]", "100"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[CurlyPhi]2maxsol", "/.", "Ex1"}], "//", 
  "N"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Lambda]2mxSol", "/.", "Ex1"}], "//", "N"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[CurlyPhi]2maxsol", "/.", "Ex2"}], "//", 
  "N"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Lambda]2mxSol", "/.", "Ex2"}], "//", "N"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[CurlyPhi]2maxsol", "/.", "Ex3"}], "//", 
  "N"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]2mxSol", "/.", "Ex3"}], "//", "N"}]}], "Input",
 CellChangeTimes->{{3.765957924108918*^9, 3.765957994058799*^9}, 
   3.7659598129432917`*^9, {3.765959878888321*^9, 3.7659598801065817`*^9}, {
   3.765959935996118*^9, 3.765959947273429*^9}, {3.765960640046021*^9, 
   3.765960643785656*^9}, {3.765960762628286*^9, 3.76596080802594*^9}, {
   3.765962771986292*^9, 3.765962776688397*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"\[CurlyPhi]2", "\[Rule]", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[CurlyPhi]2", "\[Rule]", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[CurlyPhi]2", "\[Rule]", 
     RowBox[{"-", "3.141592653589793`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[CurlyPhi]2", "\[Rule]", "3.141592653589793`"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.765957945837325*^9, 3.7659579944297543`*^9}, 
   3.765959813215165*^9, 3.765959880645054*^9, {3.7659599373601027`*^9, 
   3.765959947692511*^9}, 3.765960644145303*^9, {3.7659607811404753`*^9, 
   3.7659608103087254`*^9}, 3.765962777143276*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[Lambda]2", "\[Rule]", 
       RowBox[{"-", "0.01569612305760129`"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Lambda]2", "\[Rule]", "0.01569612305760129`"}], "}"}]}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[Lambda]2", "\[Rule]", 
       RowBox[{"-", "0.01569612305760129`"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Lambda]2", "\[Rule]", "0.01569612305760129`"}], "}"}]}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[Lambda]2", "\[Rule]", 
       RowBox[{"-", "3.125896530532192`"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Lambda]2", "\[Rule]", "3.125896530532192`"}], "}"}]}], "}"}],
    ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[Lambda]2", "\[Rule]", 
       RowBox[{"-", "3.125896530532192`"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Lambda]2", "\[Rule]", "3.125896530532192`"}], "}"}]}], 
    "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.765957945837325*^9, 3.7659579944297543`*^9}, 
   3.765959813215165*^9, 3.765959880645054*^9, {3.7659599373601027`*^9, 
   3.765959947692511*^9}, 3.765960644145303*^9, {3.7659607811404753`*^9, 
   3.7659608103087254`*^9}, 3.7659627771525917`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"\[CurlyPhi]2", "\[Rule]", 
     RowBox[{"-", "0.010001232008941346`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[CurlyPhi]2", "\[Rule]", "0.010001232008941346`"}], "}"}], ",", 
   
   RowBox[{"{", 
    RowBox[{"\[CurlyPhi]2", "\[Rule]", 
     RowBox[{"-", "3.131591421580852`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[CurlyPhi]2", "\[Rule]", "3.131591421580852`"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.765957945837325*^9, 3.7659579944297543`*^9}, 
   3.765959813215165*^9, 3.765959880645054*^9, {3.7659599373601027`*^9, 
   3.765959947692511*^9}, 3.765960644145303*^9, {3.7659607811404753`*^9, 
   3.7659608103087254`*^9}, 3.765962777158654*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[Lambda]2", "\[Rule]", 
       RowBox[{"0.`", "\[VeryThinSpace]", "-", 
        RowBox[{"0.012397020866303024`", " ", "\[ImaginaryI]"}]}]}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"\[Lambda]2", "\[Rule]", 
       RowBox[{"0.`", "\[VeryThinSpace]", "+", 
        RowBox[{"0.012397020866303024`", " ", "\[ImaginaryI]"}]}]}], "}"}]}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[Lambda]2", "\[Rule]", 
       RowBox[{"-", "0.015696907960899877`"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Lambda]2", "\[Rule]", "0.015696907960899877`"}], "}"}]}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[Lambda]2", "\[Rule]", 
       RowBox[{
        RowBox[{"-", "3.141592653589793`"}], "+", 
        RowBox[{"0.012397020866303024`", " ", "\[ImaginaryI]"}]}]}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"\[Lambda]2", "\[Rule]", 
       RowBox[{"3.141592653589793`", "\[VeryThinSpace]", "-", 
        RowBox[{"0.012397020866303024`", " ", "\[ImaginaryI]"}]}]}], "}"}]}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[Lambda]2", "\[Rule]", 
       RowBox[{"-", "3.125895745628893`"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Lambda]2", "\[Rule]", "3.125895745628893`"}], "}"}]}], 
    "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.765957945837325*^9, 3.7659579944297543`*^9}, 
   3.765959813215165*^9, 3.765959880645054*^9, {3.7659599373601027`*^9, 
   3.765959947692511*^9}, 3.765960644145303*^9, {3.7659607811404753`*^9, 
   3.7659608103087254`*^9}, 3.765962777165333*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"\[CurlyPhi]2", "\[Rule]", 
     RowBox[{"-", "1.472031792084875`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[CurlyPhi]2", "\[Rule]", "1.472031792084875`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[CurlyPhi]2", "\[Rule]", 
     RowBox[{"-", "1.6695608615049184`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[CurlyPhi]2", "\[Rule]", "1.6695608615049184`"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.765957945837325*^9, 3.7659579944297543`*^9}, 
   3.765959813215165*^9, 3.765959880645054*^9, {3.7659599373601027`*^9, 
   3.765959947692511*^9}, 3.765960644145303*^9, {3.7659607811404753`*^9, 
   3.7659608103087254`*^9}, 3.765962777173574*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[Lambda]2", "\[Rule]", 
       RowBox[{"0.`", "\[VeryThinSpace]", "-", 
        RowBox[{"6.002187102981671`", " ", "\[ImaginaryI]"}]}]}], "}"}], ",", 
     
     RowBox[{"{", 
      RowBox[{"\[Lambda]2", "\[Rule]", 
       RowBox[{"0.`", "\[VeryThinSpace]", "+", 
        RowBox[{"6.002187102981671`", " ", "\[ImaginaryI]"}]}]}], "}"}]}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[Lambda]2", "\[Rule]", 
       RowBox[{"-", "0.15787165026873975`"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Lambda]2", "\[Rule]", "0.15787165026873975`"}], "}"}]}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[Lambda]2", "\[Rule]", 
       RowBox[{
        RowBox[{"-", "3.141592653589793`"}], "+", 
        RowBox[{"6.002187102981671`", " ", "\[ImaginaryI]"}]}]}], "}"}], ",", 
     
     RowBox[{"{", 
      RowBox[{"\[Lambda]2", "\[Rule]", 
       RowBox[{"3.141592653589793`", "\[VeryThinSpace]", "-", 
        RowBox[{"6.002187102981671`", " ", "\[ImaginaryI]"}]}]}], "}"}]}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[Lambda]2", "\[Rule]", 
       RowBox[{"-", "2.9837210033210533`"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Lambda]2", "\[Rule]", "2.9837210033210533`"}], "}"}]}], 
    "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.765957945837325*^9, 3.7659579944297543`*^9}, 
   3.765959813215165*^9, 3.765959880645054*^9, {3.7659599373601027`*^9, 
   3.765959947692511*^9}, 3.765960644145303*^9, {3.7659607811404753`*^9, 
   3.7659608103087254`*^9}, 3.765962777180097*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  SqrtBox[
   RowBox[{"1", "-", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"Sec", "[", 
       FractionBox["dd", "DD"], "]"}], "2"], " ", 
     SuperscriptBox[
      RowBox[{"Sin", "[", "\[CurlyPhi]1", "]"}], "2"]}]}]], "/.", 
  "Ex2"}]], "Input",
 CellChangeTimes->{{3.765958025529471*^9, 3.765958030143009*^9}}],

Cell[BoxData[
 RowBox[{"\[ImaginaryI]", " ", 
  SqrtBox[
   RowBox[{
    RowBox[{"-", "1"}], "+", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"Sec", "[", 
       FractionBox["100", "6371"], "]"}], "2"], " ", 
     SuperscriptBox[
      RowBox[{"Sin", "[", "33", "]"}], "2"]}]}]]}]], "Output",
 CellChangeTimes->{{3.765958028983811*^9, 3.7659580303503113`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"\[Lambda]2Sol", " ", "=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Hav", "[", 
           RowBox[{
           "dd", ",", " ", "DD", ",", " ", "\[Lambda]1", ",", " ", 
            "\[Lambda]2", ",", " ", "\[CurlyPhi]1", ",", " ", 
            "\[CurlyPhi]2"}], "]"}], "/.", "Ex2"}], "//", "N"}], ")"}], 
       "\[Equal]", "0"}], ",", " ", "\[Lambda]2"}], "]"}], "//", "Simplify"}],
    ")"}]}], "\[IndentingNewLine]", 
 RowBox[{"\[CurlyPhi]2maxsol", " ", "=", " ", 
  RowBox[{
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"\[Lambda]2", "/.", "\[Lambda]2Sol"}], ")"}], "/.", 
            "Ex2"}], "//", "N"}], "//", "Simplify"}], ",", "\[CurlyPhi]2"}], 
        "]"}], "\[Equal]", "0"}], "//", "Simplify"}], ",", "\[CurlyPhi]2"}], 
    "]"}], "//", "Simplify"}]}]}], "Input",
 CellChangeTimes->{{3.765958063366214*^9, 3.7659581359823923`*^9}}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Solve", "::", "ifun"}], "MessageName"], ":", 
  " ", "\<\"Inverse functions are being used by \[NoBreak]\\!\\(Solve\\)\
\[NoBreak], so some solutions may not be found; use Reduce for complete \
solution information. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/Solve/ifun\\\", ButtonNote -> \
\\\"Solve::ifun\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{{3.7659581080100327`*^9, 3.7659581363812933`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"\[Lambda]2", "\[Rule]", 
     RowBox[{
      RowBox[{"-", "1.`"}], " ", 
      RowBox[{"ArcCos", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "75.31037547004713`"}], " ", 
         RowBox[{"Sec", "[", "\[CurlyPhi]2", "]"}]}], "+", 
        RowBox[{"75.31301480008509`", " ", 
         RowBox[{"Tan", "[", "\[CurlyPhi]2", "]"}]}]}], "]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Lambda]2", "\[Rule]", 
     RowBox[{"ArcCos", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "75.31037547004713`"}], " ", 
        RowBox[{"Sec", "[", "\[CurlyPhi]2", "]"}]}], "+", 
       RowBox[{"75.31301480008509`", " ", 
        RowBox[{"Tan", "[", "\[CurlyPhi]2", "]"}]}]}], "]"}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.765958069094017*^9, 3.7659581363926764`*^9}}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Solve", "::", "ifun"}], "MessageName"], ":", 
  " ", "\<\"Inverse functions are being used by \[NoBreak]\\!\\(Solve\\)\
\[NoBreak], so some solutions may not be found; use Reduce for complete \
solution information. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/Solve/ifun\\\", ButtonNote -> \
\\\"Solve::ifun\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{{3.7659581080100327`*^9, 3.765958136595413*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"\[CurlyPhi]2", "\[Rule]", 
     RowBox[{"1.5707963267948966`", "\[VeryThinSpace]", "-", 
      RowBox[{"0.008372076215223914`", " ", "\[ImaginaryI]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[CurlyPhi]2", "\[Rule]", 
     RowBox[{"1.5707963267948966`", "\[VeryThinSpace]", "+", 
      RowBox[{"0.008372076215223914`", " ", "\[ImaginaryI]"}]}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.765958069094017*^9, 3.76595813660376*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["", "Subsubsection",
 CellChangeTimes->{{3.7659998586085033`*^9, 3.76599986038367*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"1", "<", "2"}]], "Input",
 CellChangeTimes->{{3.766001420116679*^9, 3.766001420796699*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.7660014210475388`*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{871, 808},
WindowMargins->{{Automatic, 0}, {Automatic, 0}},
FrontEndVersion->"10.1 for Mac OS X x86 (32-bit, 64-bit Kernel) (March 23, \
2015)",
StyleDefinitions->FrontEnd`FileName[{$RootDirectory, "Users", "Halmagyi", 
   "Documents", "Physics", "Physics_Notes", "Mathematica", "Stylesheets"}, 
  "PastelColor.nb", CharacterEncoding -> "UTF-8"]
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 184, 2, 57, "Section"],
Cell[CellGroupData[{
Cell[789, 28, 1148, 29, 56, "Input"],
Cell[1940, 59, 927, 26, 87, "Output"]
}, Open  ]],
Cell[2882, 88, 1209, 27, 76, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4128, 120, 117, 1, 57, "Section"],
Cell[CellGroupData[{
Cell[4270, 125, 866, 20, 38, "Input"],
Cell[5139, 147, 1615, 37, 94, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[6791, 189, 844, 20, 38, "Input"],
Cell[7638, 211, 802, 15, 24, "Message"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8477, 231, 882, 22, 67, "Input"],
Cell[9362, 255, 2820, 78, 211, "Output"]
}, Open  ]],
Cell[12197, 336, 739, 21, 38, "Input"],
Cell[CellGroupData[{
Cell[12961, 361, 602, 17, 58, "Input"],
Cell[13566, 380, 133, 2, 38, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[13748, 388, 112, 1, 57, "Section"],
Cell[CellGroupData[{
Cell[13885, 393, 3066, 77, 124, "Input"],
Cell[16954, 472, 978, 24, 54, "Output"],
Cell[17935, 498, 966, 25, 53, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[18938, 528, 770, 22, 58, "Input"],
Cell[19711, 552, 458, 10, 38, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[20206, 567, 511, 14, 58, "Input"],
Cell[20720, 583, 156, 3, 38, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[20913, 591, 417, 9, 38, "Input"],
Cell[21333, 602, 608, 17, 58, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[21990, 625, 94, 1, 57, "Section"],
Cell[22087, 628, 761, 21, 90, "Input"],
Cell[22851, 651, 838, 22, 56, "Input"],
Cell[CellGroupData[{
Cell[23714, 677, 152, 3, 38, "Input"],
Cell[23869, 682, 283, 7, 38, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[24189, 694, 298, 7, 38, "Input"],
Cell[24490, 703, 602, 19, 38, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[25129, 727, 718, 17, 38, "Input"],
Cell[25850, 746, 237, 3, 42, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[26124, 754, 159, 4, 42, "Input"],
Cell[26286, 760, 97, 1, 38, "Output"]
}, Open  ]],
Cell[26398, 764, 1142, 32, 84, "Input"],
Cell[CellGroupData[{
Cell[27565, 800, 139, 2, 38, "Input"],
Cell[27707, 804, 73, 1, 38, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[27817, 810, 1997, 53, 209, "Input"],
Cell[29817, 865, 685, 16, 38, "Output"],
Cell[30505, 883, 1356, 38, 56, "Output"],
Cell[31864, 923, 746, 18, 38, "Output"],
Cell[32613, 943, 1729, 47, 73, "Output"],
Cell[34345, 992, 738, 17, 38, "Output"],
Cell[35086, 1011, 1717, 47, 73, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[36840, 1063, 343, 11, 67, "Input"],
Cell[37186, 1076, 365, 11, 67, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[37588, 1092, 1156, 33, 73, "Input"],
Cell[38747, 1127, 546, 10, 41, "Message"],
Cell[39296, 1139, 871, 24, 56, "Output"],
Cell[40170, 1165, 544, 10, 41, "Message"],
Cell[40717, 1177, 519, 12, 38, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[41273, 1194, 92, 1, 25, "Subsubsection"],
Cell[CellGroupData[{
Cell[41390, 1199, 115, 2, 38, "Input"],
Cell[41508, 1203, 75, 1, 38, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
